# Operationalizing an ML project

The aim of the project is to operationalize an Ml pipeline. We start with a bank marketing dataset, run automl process
to obtain a model with high accuracy, deploy this model as a rest endpoint with swagger enabled, enable logging for the project,
Consume and test the end point if he entire process is well implemented.

## Architectural Diagram
The diagram below explains the architecture of the project.
The process can be divided into two main parts as in a typical ML lifecycle. 
First is That of getting the data and training a model.
Second is that of getting the model and puuting it behind a rest end point for consumption. This is done using the azure container infrastructure

![Architecture diagram](https://github.com/abhijit-kalita/nd00333_AZMLND_C2/blob/master/starter_files/images/Project_Architecture.png)&nbsp;&nbsp;&nbsp;&nbsp;


## Key Steps

### Key steps in the operationalization of a machine learning process:


:one:   **Dataset creation:** A dataset is ingested which is a bank markerketing dataset provided for the project. The dataset shares details about the population targetted for a subscription offer and the retlated details. The dataset is created in the azure ml workspace for use


![Dataset](https://github.com/abhijit-kalita/nd00333_AZMLND_C2/blob/master/starter_files/images/Bankmktng_Dataset.png)

:two:   **AUTOML** In the subsequent step, using the dataset created in provious step an automl process is run with the Y/N colums regarding whether a subscription happened as the classification prediction target

![Automl completed](https://github.com/abhijit-kalita/nd00333_AZMLND_C2/blob/master/starter_files/images/Automl_completed_exp.png)

:three:   **Best model deployment:** Following an automl run the best model which is obtained as a result of the automl process is chosen for deployment. The deployment is to be  made as a rest end point with teh help of an azure container instance

![Best Automl model](https://github.com/abhijit-kalita/nd00333_AZMLND_C2/blob/master/starter_files/images/Automl_Best_exp.png)

:four:   **Enabling of app insights:** To better monitor the deployed model the application insignts for the deployed model has to be ebablaed.This is done by running a puthon sccipt using azureml sdk where the the enable_app_insights is set to True. Once this is done the app insights value can be seen as enabled in the model details

![Running of logs.py](https://github.com/abhijit-kalita/nd00333_AZMLND_C2/blob/master/starter_files/images/logs-py-run.png)

![App Insights is marked enables](https://github.com/abhijit-kalita/nd00333_AZMLND_C2/blob/master/starter_files/images/app-insights-enabled.png)


:five:   **Enable swagger for the end point:** To test out the deployed model swagger utility can be used. Inorder to do this the json generated by deployed model is downloaded. A shell script is run which downloads a docker container containing swagger and runs it locally . And finally a serve.py python file is used to serve the model .
Using this setup the swagger specific to the rest endpoint can be viewed in swagger ui served by the locally deployed swagger container.

![Swagger1](https://github.com/abhijit-kalita/nd00333_AZMLND_C2/blob/master/starter_files/images/swagger-json-serving.png)


:six: **Consumption of deployed endpoint:** The deployed end point can be tested with endpoint.py python script which passes the expented contents of the model 
rest enpoint as a json payload and then gets back the classified end point as a yes/no response .

![Rest endpoint execution 1](https://github.com/abhijit-kalita/nd00333_AZMLND_C2/blob/master/starter_files/images/end-point-execution-json.png)

![Rest endpoint execution 2](https://github.com/abhijit-kalita/nd00333_AZMLND_C2/blob/master/starter_files/images/endpoint-execution.png)

:seven: **Load testing:** The rest end point can be tested using apache benchmark utility. 10 requests are sent to the end point and response checked for parious parammeters 
like best respinse time, failures etc

![benchmark test](https://github.com/abhijit-kalita/nd00333_AZMLND_C2/blob/master/starter_files/images/Benchmark-test-api.png)

:eight: **ML Pipeline creation:** As part of the sutomation process a reuable ml pipeline can be created with the various steps. The revelant code can be writeen and executed
as a jupyter notebook at the end of which you will have an ML pipeline created in azure ml.

![Pipeline creation](https://github.com/abhijit-kalita/nd00333_AZMLND_C2/blob/master/starter_files/images/pipeline-notebook-run2.png)

![Pipeline creation2](https://github.com/abhijit-kalita/nd00333_AZMLND_C2/blob/master/starter_files/images/pipelin120.png)


:nine: **ML Pipeline publishing:** The created pipeline is then published for consumption

![Pipeline publication 1](https://github.com/abhijit-kalita/nd00333_AZMLND_C2/blob/master/starter_files/images/pipeline7.png)



![Pipeline publication 2](https://github.com/abhijit-kalita/nd00333_AZMLND_C2/blob/master/starter_files/images/pipeline8.png)



![Pipeline rest end point](https://github.com/abhijit-kalita/nd00333_AZMLND_C2/blob/master/starter_files/images/pipeline11.png)


* **Published pipeline active status:** The published pipeline in active status can be seen below

![Pipeline rest end point](https://github.com/abhijit-kalita/nd00333_AZMLND_C2/blob/master/starter_files/images/published-pipeline-overview.png)



## Screen Recording
[Screencast Link of Project](https://youtu.be/9Y6MumokV9Y)

## Standout Suggestions/Improvements
Some improvements which can be attemped are
Get a better model by changing/optimizing the automl run
Automate a scheduled test of the rest end point to check if the performance degrades and launch a retraining based on that


